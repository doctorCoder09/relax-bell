<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Relaxation Bell</title>
<style>
  body { margin:0; font-family:"Inter",sans-serif; transition: background-color 0.3s, color 0.3s; background-color:#ffffff; color:#1a202c; }
  body.dark { background-color:#1a202c; color:#f7fafc; }

  .container { display:flex; flex-direction:column; align-items:center; padding:20px; }
  .image-container { position:relative; width:100%; max-width:800px; aspect-ratio:16/9; overflow:hidden; border-radius:12px; margin-bottom:20px; cursor:pointer; transition: transform 0.3s; }
  .image-container:hover img { transform: scale(1.05); }
  .image-container img { width:100%; height:100%; object-fit:cover; transition: transform 0.3s; }

  .theme-button { position:fixed; top:15px; right:15px; width:40px; height:40px; font-size:1.2rem; padding:5px; border-radius:50%; background-color:#3182ce; color:white; border:none; cursor:pointer; transition: all 0.2s ease; z-index:1000; }
  .theme-button:hover { transform: scale(1.2); background-color:#2b6cb0; }

  .controls { max-width:500px; width:100%; display:flex; flex-direction:column; gap:15px; }
  input[type="range"], input[type="time"] { width:100%; }
  .button-toggle { padding:10px 20px; border:none; border-radius:8px; font-size:1rem; cursor:pointer; color:white; transition: transform 0.2s; }
  .button-toggle:hover { transform: scale(1.05); }
  .button-on { background-color:#e53e3e; }
  .button-off { background-color:#38a169; }
</style>
</head>
<body>

<button id="themeButton" class="theme-button" title="ƒê·ªïi theme">üåô</button>

<div class="container">
  <h1>Relaxation Bell</h1>

  <div id="imageContainer" class="image-container">
    <img id="mainImage" src="https://picsum.photos/1200/600?blur=1" alt="Relaxation">
  </div>

  <div class="controls">
    <label>√Çm l∆∞·ª£ng: <span id="volumeLabel">80%</span></label>
    <input type="range" id="volumeRange" min="0" max="100" step="5" value="80">

    <label>Kho·∫£ng nh·∫Øc: <span id="intervalLabel">30 ph√∫t</span></label>
    <input type="range" id="intervalRange" min="5" max="60" step="5" value="30">

    <label>Th·ªùi gian ho·∫°t ƒë·ªông:</label>
    <div style="display:flex; gap:10px;">
      <input type="time" id="startTime" value="07:30">
      <span>‚Üí</span>
      <input type="time" id="endTime" value="16:30">
    </div>

    <button id="toggleBell" class="button-toggle button-on">T·∫Øt chu√¥ng nh·∫Øc</button>
  </div>
</div>

<script>
  // --- Theme & Image ---
  const themeButton = document.getElementById('themeButton');
  const body = document.body;
  const mainImage = document.getElementById('mainImage');
  const IMAGE_LIGHT = "https://picsum.photos/1200/600?blur=1";
  const IMAGE_DARK = "https://picsum.photos/1200/600?blur=1&grayscale=true";

  let isDark = window.matchMedia("(prefers-color-scheme: dark)").matches;
  function applyTheme(theme){
    if(theme==='dark'){ body.classList.add('dark'); mainImage.src=IMAGE_DARK; }
    else { body.classList.remove('dark'); mainImage.src=IMAGE_LIGHT; }
  }
  applyTheme(isDark?'dark':'light');

  themeButton.onclick = () => {
    isDark = !isDark;
    applyTheme(isDark?'dark':'light');
    themeButton.textContent = isDark ? "üåû" : "üåô";
  };

  // --- Bell Sound ---
  const BELL_URL = "https://soundbible.com/mp3/Temple%20Bell-SoundBible.com-756181215.mp3";
  const audio = new Audio(BELL_URL); audio.preload="auto"; let isSoundReady=true;

  mainImage.onclick = () => {
    if(isSoundReady){ isSoundReady=false; audio.currentTime=0;
      audio.play().catch(e=>console.warn(e)).finally(()=>isSoundReady=true);
    }
  };

  // --- Controls ---
  const volumeRange = document.getElementById('volumeRange');
  const volumeLabel = document.getElementById('volumeLabel');
  volumeRange.addEventListener('input', e=>{
    const vol = e.target.value; audio.volume=vol/100; volumeLabel.textContent=vol+'%';
  });

  const intervalRange = document.getElementById('intervalRange');
  const intervalLabel = document.getElementById('intervalLabel');
  let intervalMinutes = parseInt(intervalRange.value); 
  intervalRange.addEventListener('input', e=>{
    intervalMinutes=parseInt(e.target.value); intervalLabel.textContent=intervalMinutes+' ph√∫t'; resetTimer();
  });

  const startTimeInput = document.getElementById('startTime');
  const endTimeInput = document.getElementById('endTime');

  let isEnabled=true;
  const toggleBell = document.getElementById('toggleBell');
  toggleBell.onclick = ()=>{
    isEnabled = !isEnabled;
    toggleBell.textContent = isEnabled?"T·∫Øt chu√¥ng nh·∫Øc":"B·∫≠t chu√¥ng nh·∫Øc";
    toggleBell.className=`button-toggle ${isEnabled?'button-on':'button-off'}`;
    resetTimer();
  };

  let timer;
  function parseTime(str){
    const [h,m] = str.split(':').map(Number);
    const d = new Date();
    d.setHours(h,m,0,0);
    return d;
  }

  function checkAndPlay(){
    if(!isEnabled) return;
    const now=new Date();
    const start=parseTime(startTimeInput.value);
    const end=parseTime(endTimeInput.value);
    if(now>=start && now<=end){ mainImage.click(); }
  }

  function resetTimer(){
    if(timer) clearInterval(timer);
    if(isEnabled){ checkAndPlay(); timer=setInterval(checkAndPlay, intervalMinutes*60*1000); }
  }

  resetTimer();
</script>

</body>
</html>

